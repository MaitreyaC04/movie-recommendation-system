<nav style="display:flex; justify-content:space-between; align-items:center; 
            padding:10px 20px; background-color:#222; color:white;">

    <!-- Logo -->
    <div style="font-size:32px; font-weight:bold; color:#ffcc00;">
        CineMatch
    </div>

    <!-- Right side -->
    <div style="display:flex; align-items:center; gap:15px;">

        <!-- Profile Dropdown -->
        <div id="profileMenu" style="position:relative;">
            <!-- Profile picture or initials -->
            {% if user_details.profile_picture %}
                <img src="{{ url_for('static', filename='uploads/' + user.profile_picture) }}" 
                     alt="Profile" 
                     style="width:40px; height:40px; border-radius:50%; cursor:pointer; border:2px solid #ffcc00;"
                     onclick="toggleDropdown()">
            {% else %}
                <div onclick="toggleDropdown()" 
                     style="width:40px; height:40px; border-radius:50%; 
                            background:#ffcc00; color:#222; 
                            display:flex; align-items:center; 
                            justify-content:center; font-weight:bold; 
                            cursor:pointer; border:2px solid white;">
                    {{ user_details.first_name[0] }}{{ user_details.last_name[0] }}
                </div>
            {% endif %}

            <!-- Dropdown menu -->
            <div id="profileDropdown" 
                 style="opacity:0; visibility:hidden; position:absolute; right:0; top:50px; 
                        background:#333; padding:10px; border-radius:8px; min-width:150px;
                        box-shadow:0 4px 10px rgba(0,0,0,0.3); z-index:100; 
                        transition:opacity 0.3s ease, transform 0.3s ease, visibility 0.3s;">
                <a href="{{ url_for('auth.view_profile') }}" 
                   style="color:white; text-decoration:none; display:block; padding:8px 12px; border-radius:5px; transition:0.3s;">
                    View Profile
                </a>
                <a href="{{ url_for('auth.preferences') }}" 
                   style="color:white; text-decoration:none; display:block; padding:8px 12px; border-radius:5px; transition:0.3s;">
                    Preferences
                </a>
            </div>
        </div>

        <!-- Logout Button -->
        <a href="{{ url_for('auth.logout') }}" 
           style="background:red; color:white; text-decoration:none; padding:8px 15px;
                  border:1px solid white; border-radius:5px; transition:0.3s;">
            Logout
        </a>

        
    </div>
</nav>

<script>
function toggleDropdown() {
    const dropdown = document.getElementById("profileDropdown");
    if (dropdown.style.visibility === "visible") {
        dropdown.style.opacity = "0";
        dropdown.style.transform = "translateY(-10px)";
        setTimeout(() => dropdown.style.visibility = "hidden", 300);
    } else {
        dropdown.style.visibility = "visible";
        dropdown.style.opacity = "1";
        dropdown.style.transform = "translateY(0)";
    }
}

// Close dropdown when clicking outside
document.addEventListener("click", function(event) {
    const dropdown = document.getElementById("profileDropdown");
    const profileMenu = document.getElementById("profileMenu");
    if (dropdown.style.visibility === "visible" && !profileMenu.contains(event.target)) {
        dropdown.style.opacity = "0";
        dropdown.style.transform = "translateY(-10px)";
        setTimeout(() => dropdown.style.visibility = "hidden", 300);
    }
});
</script>

<style>
/* Hover effects for dropdown links */
#profileDropdown a:hover {
    background:#444;
    color:#ffcc00;
}
a:hover {
    background:#444;
}
</style>
